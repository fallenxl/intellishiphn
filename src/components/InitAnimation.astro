---
import Logo from "../icons/Logo.astro";
let logoColor = "#00ccd3";
---

<div
  class="animation-container fixed top-0 left-0 w-full h-full flex justify-center items-center z-[99999999] bg-white"
>
  <Logo color={logoColor} size={80} animation={true} />
  <div class="bg-transition fixed scale-y-0 origin-top w-screen h-screen -z-10">
  </div>
</div>
<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import { SplitText } from "gsap/SplitText";
  gsap.registerPlugin(ScrollTrigger, SplitText);

  let initPageRef = document.querySelector(".animation-container") as HTMLElement;
  let bgTransitionRef = document.querySelector(".bg-transition") as HTMLElement;
  let logoBars = gsap.utils.toArray(".logo-bar") as HTMLElement[];


  const tl = gsap.timeline({});

  logoBars.forEach((bar, index) => {
    tl.set(bar, { fill: "#00ccd3" });
  });



  if (initPageRef) {
    tl.to(initPageRef, {
      duration: 1,
      ease: "power3.out",
      delay: 0.5,
    })

      .to(bgTransitionRef, {
        duration: 1,
        transformOrigin: "bottom center",
        scaleY: 1,
        backgroundColor: "#00ccd3",
        ease: "power3.out",
      })
      .to(
        logoBars,
        {
          fill: "white",
          duration: 0.2,
        },
        "<"
      )
      .to(initPageRef, {
        duration: 1,
        opacity: 0,
        ease: "power3.out",
        onComplete: () => {
          if (initPageRef) {
            initPageRef.style.display = "none";
          }
        },
      });

    tl.set(logoBars, { fill: "#46d9e3" }, "<");

  }
  
</script>
